<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cão Amigo - Gerenciamento de Adoções</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-primary: #10B981; /* Emerald */
            --color-secondary: #FBBF24; /* Amber */
            --color-background: #F9FAFB; /* Gray-50 */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-background);
        }
        .card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .tab-active {
            border-bottom: 3px solid var(--color-primary);
            color: var(--color-primary);
            font-weight: 600;
        }
        .btn-primary {
            background-color: var(--color-primary);
            transition: background-color 0.15s;
        }
        .btn-primary:hover {
            background-color: #059669; /* Emerald 600 */
        }
    </style>
    <script>
        // CONFIGURAÇÕES
        // A URL base da API foi atualizada para o link fornecido pelo usuário.
        const API_BASE_URL = "https://api-caoamigo.onrender.com"; 

        // ESTADO GLOBAL
        let state = {
            currentEntity: 'cachorros', // 'cachorros', 'adocoes', 'racas'
            currentPage: 'list', // 'list', 'form'
            data: [], // Dados da lista
            selectedId: null, // ID para edição/visualização
        };

        const entitiesMap = {
            'cachorros': { 
                title: 'Cachorros', 
                endpoint: '/cachorros',
                fields: {
                    nome: { type: 'text', label: 'Nome', required: true, maxlength: 100, minlength: 2 },
                    dataDeNascimento: { type: 'date', label: 'Data de Nascimento', required: false },
                    localDeResgate: { type: 'text', label: 'Local de Resgate', required: true, maxlength: 80 },
                    // Ficha Cachorro fields (nested - simplified for a single form)
                    descricaoHistoria: { type: 'textarea', label: 'História', required: false, maxlength: 2000 },
                    temperamentoPrincipal: { type: 'text', label: 'Temperamento Principal', required: false, maxlength: 200 },
                    habilidadesEspeciais: { type: 'text', label: 'Habilidades Especiais', required: false },
                }
            },
            'adocoes': { 
                title: 'Adoções', 
                endpoint: '/adocoes',
                fields: {
                    dataSolicitacao: { type: 'date', label: 'Data da Solicitação', required: true },
                    justificativa: { type: 'textarea', label: 'Justificativa', required: true, maxlength: 2000 },
                    status: { type: 'select', label: 'Status', required: true, options: ['PENDENTE', 'APROVADA', 'REJEITADA'] },
                    // Simplificação: Cachorro e Raças seriam IDs de seleção em um app real
                    cachorroId: { type: 'text', label: 'ID Cachorro', required: false }, 
                }
            },
            'racas': { 
                title: 'Raças', 
                endpoint: '/racas',
                fields: {
                    nome: { type: 'text', label: 'Nome da Raça', required: true, maxlength: 50, minlength: 2 },
                    descricao: { type: 'textarea', label: 'Descrição', required: false, maxlength: 200 },
                }
            }
        };

        // UTILS
        const showMessage = (message, type = 'success') => {
            const container = document.getElementById('message-container');
            const color = type === 'success' ? 'bg-green-100 border-green-400 text-green-700' : 
                          type === 'error' ? 'bg-red-100 border-red-400 text-red-700' : 
                          'bg-blue-100 border-blue-400 text-blue-700';
            container.innerHTML = `
                <div class="p-3 mb-4 rounded-lg border ${color}" role="alert">
                    ${message}
                </div>
            `;
            setTimeout(() => { container.innerHTML = ''; }, 5000);
        };

        const formatDate = (dateString) => {
            if (!dateString) return 'N/A';
            try {
                return new Date(dateString).toLocaleDateString('pt-BR');
            } catch {
                return dateString;
            }
        };

        const fetchWithRetry = async (url, options = {}, retries = 3) => {
            const apiKey = ""; // API key is handled by the environment
            if (apiKey) {
                options.headers = { ...options.headers, 'X-API-Key': apiKey };
            }
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, options);
                    if (!response.ok) {
                        const errorText = await response.text();
                        // Lança um erro com a mensagem de resposta HTTP para melhor depuração
                        throw new Error(`HTTP error! Status: ${response.status}. Message: ${errorText || 'Unknown error'}`);
                    }
                    return response;
                } catch (error) {
                    console.error(`Attempt ${i + 1} failed for ${url}:`, error);
                    if (i === retries - 1) throw error;
                    const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                    await new Promise(res => setTimeout(res, delay));
                }
            }
        };

        // API INTERAÇÕES
        const fetchEntityList = async (entity, query = '') => {
            const endpoint = entitiesMap[entity].endpoint + (query ? `/search?q=${query}` : '');
            // NOTA: A API está configurada para retornar listas completas no GET /entidade, e filtradas/paginadas no /entidade/search
            const fullUrl = `${API_BASE_URL}${query ? '/search' : ''}`; // Ajuste para a rota de busca
            const url = `${API_BASE_URL}${endpoint}${query ? '' : ''}`; // Usando o endpoint completo

            // Se for busca, usa a rota /search e adiciona os parâmetros de paginação
            let finalUrl = `${API_BASE_URL}${entitiesMap[entity].endpoint}`;
            if (query) {
                // Adiciona parâmetros de busca e paginação (usando defaults da spec OpenAPI)
                finalUrl = `${API_BASE_URL}${entitiesMap[entity].endpoint}/search?q=${encodeURIComponent(query)}&page=0&size=4&sort=id&direction=asc`;
            }

            document.getElementById('loading-indicator').classList.remove('hidden');
            try {
                const response = await fetchWithRetry(finalUrl, { method: 'GET' });
                const realData = await response.json();
                
                state.data = realData;
                showMessage(`Lista de ${entitiesMap[entity].title} carregada com sucesso da API.`, 'success');
                return realData;
            } catch (error) {
                console.error(`Erro ao buscar ${entity} na API:`, error);
                // Fallback para dados mockados em caso de falha de conexão/API
                const mockData = generateMockData(entity);
                if (query) {
                     // Filtra mocks se for uma busca
                    return mockData.filter(item => 
                        Object.values(item).some(val => 
                            String(val).toUpperCase().includes(query.toUpperCase())
                        )
                    );
                }
                state.data = mockData;
                showMessage(`Erro ao conectar com a API (${error.message}). Exibindo dados de demonstração.`, 'error');
                return state.data;
            } finally {
                document.getElementById('loading-indicator').classList.add('hidden');
            }
        };

        const saveEntity = async (entity, data, id = null) => {
            const endpoint = entitiesMap[entity].endpoint + (id ? `/${id}` : '');
            const url = `${API_BASE_URL}${endpoint}`;
            const method = id ? 'PUT' : 'POST';

            document.getElementById('loading-indicator').classList.remove('hidden');
            try {
                // Remove o ID para POST (a API gera) e se for PUT, ele já está na URL
                delete data.id; 
                
                await fetchWithRetry(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                showMessage(`${entitiesMap[entity].title} ${id ? 'atualizado' : 'criado'} com sucesso!`, 'success');
                return true;
            } catch (error) {
                console.error(`Erro ao salvar ${entity}:`, error);
                showMessage(`Erro ao salvar: ${error.message}.`, 'error');
                return false;
            } finally {
                document.getElementById('loading-indicator').classList.add('hidden');
            }
        };

        const deleteEntity = async (entity, id) => {
            const endpoint = `${entitiesMap[entity].endpoint}/${id}`;
            const url = `${API_BASE_URL}${endpoint}`;
            
            // Usando modal customizado para não usar `confirm()`
            if (!await showConfirmationModal(`Tem certeza que deseja deletar o ID ${id} de ${entitiesMap[entity].title}?`)) {
                return false;
            }

            document.getElementById('loading-indicator').classList.remove('hidden');
            try {
                await fetchWithRetry(url, { method: 'DELETE' });
                
                showMessage(`${entitiesMap[entity].title} (ID: ${id}) deletado com sucesso.`, 'success');
                return true;
            } catch (error) {
                console.error(`Erro ao deletar ${entity}:`, error);
                showMessage(`Erro ao deletar: ${error.message}.`, 'error');
                return false;
            } finally {
                document.getElementById('loading-indicator').classList.add('hidden');
                // Recarregar a lista após a exclusão
                showPage('list', entity);
            }
        };

        // MODAL CUSTOMIZADO (SUBSTITUINDO alert/confirm)
        const showConfirmationModal = (message) => {
            return new Promise(resolve => {
                const modalHtml = `
                    <div id="custom-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50">
                        <div class="bg-white p-6 rounded-xl card max-w-sm w-full">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Confirmação Necessária</h3>
                            <p class="text-gray-600 mb-6">${message}</p>
                            <div class="flex justify-end space-x-3">
                                <button id="modal-cancel" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition">Cancelar</button>
                                <button id="modal-confirm" class="px-4 py-2 text-white bg-red-600 rounded-lg hover:bg-red-700 transition">Confirmar</button>
                            </div>
                        </div>
                    </div>
                `;
                document.body.insertAdjacentHTML('beforeend', modalHtml);

                const modal = document.getElementById('custom-modal');
                
                document.getElementById('modal-cancel').onclick = () => {
                    modal.remove();
                    resolve(false);
                };
                document.getElementById('modal-confirm').onclick = () => {
                    modal.remove();
                    resolve(true);
                };
            });
        };

        // FUNÇÕES DE RENDERIZAÇÃO
        const renderHeader = () => {
            const nav = document.getElementById('main-nav');
            nav.innerHTML = `
                ${['cachorros', 'adocoes', 'racas'].map(key => `
                    <button onclick="showPage('list', '${key}')"
                        class="p-4 transition duration-150 ease-in-out hover:bg-gray-100 
                        ${state.currentEntity === key ? 'tab-active' : 'text-gray-500'}"
                    >
                        ${entitiesMap[key].title}
                    </button>
                `).join('')}
            `;
        };

        const renderListPage = () => {
            const container = document.getElementById('content-container');
            const entityConfig = entitiesMap[state.currentEntity];
            
            // Container principal da lista
            container.innerHTML = `
                <div class="flex flex-col sm:flex-row justify-between items-center mb-6 p-4 bg-white rounded-xl card">
                    <h2 class="text-2xl font-bold text-gray-700 mb-4 sm:mb-0">Lista de ${entityConfig.title}</h2>
                    <div class="flex space-x-2 w-full sm:w-auto">
                        <input id="search-input" type="text" placeholder="Buscar por nome ou ID..." 
                               class="p-2 border border-gray-300 rounded-lg w-full sm:w-64 focus:ring-emerald-500 focus:border-emerald-500">
                        <button onclick="handleSearch()" class="btn-primary text-white p-2 rounded-lg font-semibold whitespace-nowrap">
                            Buscar
                        </button>
                        <button onclick="showPage('form')" class="btn-primary text-white p-2 rounded-lg font-semibold whitespace-nowrap">
                            + Novo
                        </button>
                    </div>
                </div>

                <div id="entity-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${state.data.length > 0 ? state.data.map(item => renderListItem(item, entityConfig.title)).join('') : `
                        <div class="col-span-full p-10 text-center bg-white rounded-xl card text-gray-500">
                            Nenhum registro encontrado.
                        </div>
                    `}
                </div>
            `;
            
            document.getElementById('search-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSearch();
            });

            // Adiciona evento de exclusão após o HTML ser renderizado
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.onclick = (e) => deleteEntity(state.currentEntity, e.currentTarget.dataset.id);
            });
            // Adiciona evento de edição
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.onclick = (e) => {
                    state.selectedId = e.currentTarget.dataset.id;
                    showPage('form');
                };
            });
        };

        const renderListItem = (item, entityTitle) => {
            let details = '';
            let icon = '';
            let mainField = item.id;

            switch (state.currentEntity) {
                case 'cachorros':
                    mainField = item.nome || `ID ${item.id}`;
                    details = `<p class="text-sm text-gray-600">Local: ${item.localDeResgate || 'N/A'}</p>
                               <p class="text-sm text-gray-600">Nascimento: ${formatDate(item.dataDeNascimento)}</p>`;
                    icon = `<div class="p-3 bg-yellow-200 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 5.636l-3.536 3.536m0 0a3.536 3.536 0 10-5.008 0l3.536-3.536zm0 0l-3.536 3.536m0 0a3.536 3.536 0 10-5.008 0l3.536-3.536zm-3.536 3.536l-3.536-3.536m0 0a3.536 3.536 0 105.008 0l-3.536 3.536zm3.536 3.536l-3.536 3.536m0 0a3.536 3.536 0 105.008 0l-3.536-3.536z" /></svg></div>`;
                    break;
                case 'adocoes':
                    mainField = `Solicitação ${item.id}`;
                    details = `<p class="text-sm text-gray-600">Data: ${formatDate(item.dataSolicitacao)}</p>
                               <p class="text-sm text-gray-600">Cachorro: ${item.cachorro?.nome || 'N/A'}</p>
                               <span class="text-xs font-semibold px-2 py-0.5 rounded-full ${item.status === 'APROVADA' ? 'bg-green-200 text-green-800' : item.status === 'REJEITADA' ? 'bg-red-200 text-red-800' : 'bg-yellow-200 text-yellow-800'}">${item.status}</span>`;
                    icon = `<div class="p-3 bg-blue-200 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 13l-3 3m0 0l-3-3m3 3V8m0 12a9 9 0 110-18 9 9 0 010 18z" /></svg></div>`;
                    break;
                case 'racas':
                    mainField = item.nome || `ID ${item.id}`;
                    details = `<p class="text-sm text-gray-600">${item.descricao ? item.descricao.substring(0, 50) + '...' : 'Sem descrição'}</p>`;
                    icon = `<div class="p-3 bg-purple-200 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.03 12.03 0 003 12c0 3.072 1.884 5.747 4.5 7.008V15" /></svg></div>`;
                    break;
            }

            return `
                <div class="bg-white p-5 rounded-xl card hover:shadow-lg transition duration-200 flex items-start space-x-4">
                    ${icon}
                    <div class="flex-grow">
                        <h3 class="text-xl font-semibold text-gray-800">${mainField}</h3>
                        ${details}
                        <p class="text-xs text-gray-400 mt-1">ID: ${item.id}</p>
                    </div>
                    <div class="flex space-x-2">
                        <button data-id="${item.id}" class="edit-btn p-2 text-white bg-blue-500 hover:bg-blue-600 rounded-full transition duration-150" title="Editar">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536L15.232 5.232z" /></svg>
                        </button>
                        <button data-id="${item.id}" class="delete-btn p-2 text-white bg-red-500 hover:bg-red-600 rounded-full transition duration-150" title="Excluir">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                        </button>
                    </div>
                </div>
            `;
        };
        
        const renderFormPage = () => {
            const container = document.getElementById('content-container');
            const entityConfig = entitiesMap[state.currentEntity];
            const isEditing = state.selectedId !== null;
            const currentItem = isEditing ? state.data.find(item => String(item.id) === String(state.selectedId)) : {};
            
            // Reconstroi o objeto para edição, incluindo campos aninhados de FichaCachorro
            let formData = {};
            if (isEditing && state.currentEntity === 'cachorros') {
                formData = { ...currentItem, ...currentItem.ficha };
            } else if (isEditing) {
                // Para Adocao, preenche o ID do Cachorro para edição
                if (state.currentEntity === 'adocoes' && currentItem.cachorro) {
                    formData.cachorroId = currentItem.cachorro.id;
                }
                formData = { ...formData, ...currentItem };
            }

            container.innerHTML = `
                <div class="bg-white p-6 sm:p-8 rounded-xl card max-w-2xl mx-auto">
                    <h2 class="text-3xl font-extrabold text-gray-800 mb-6">
                        ${isEditing ? 'Editar' : 'Novo'} ${entityConfig.title.slice(0, -1)}
                    </h2>
                    <form id="entity-form">
                        <input type="hidden" name="id" value="${formData.id || ''}">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            ${Object.entries(entityConfig.fields).map(([key, field]) => {
                                const value = formData[key] !== undefined ? formData[key] : '';
                                const inputClass = "w-full p-3 border border-gray-300 rounded-lg focus:ring-emerald-500 focus:border-emerald-500";

                                if (field.type === 'textarea') {
                                    return `
                                        <div class="md:col-span-2">
                                            <label for="${key}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}${field.required ? ' *' : ''}</label>
                                            <textarea id="${key}" name="${key}" rows="3" 
                                                      class="${inputClass}" 
                                                      maxlength="${field.maxlength || ''}" 
                                                      ${field.required ? 'required' : ''}>${value}</textarea>
                                        </div>
                                    `;
                                } else if (field.type === 'select') {
                                    return `
                                        <div>
                                            <label for="${key}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}${field.required ? ' *' : ''}</label>
                                            <select id="${key}" name="${key}" class="${inputClass}" ${field.required ? 'required' : ''}>
                                                ${field.options.map(opt => `<option value="${opt}" ${value === opt ? 'selected' : ''}>${opt}</option>`).join('')}
                                            </select>
                                        </div>
                                    `;
                                }
                                
                                // Default input (text, date)
                                return `
                                    <div>
                                        <label for="${key}" class="block text-sm font-medium text-gray-700 mb-1">${field.label}${field.required ? ' *' : ''}</label>
                                        <input type="${field.type}" id="${key}" name="${key}" value="${value}" 
                                               class="${inputClass}" 
                                               maxlength="${field.maxlength || ''}"
                                               minlength="${field.minlength || ''}"
                                               ${field.required ? 'required' : ''}>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        
                        <div class="mt-8 pt-4 border-t border-gray-200 flex justify-end space-x-4">
                            <button type="button" onclick="showPage('list')" class="px-5 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition duration-150 font-semibold">
                                Cancelar
                            </button>
                            <button type="submit" class="btn-primary text-white px-5 py-2 rounded-lg font-semibold">
                                ${isEditing ? 'Salvar Alterações' : 'Cadastrar'}
                            </button>
                        </div>
                    </form>
                </div>
            `;

            document.getElementById('entity-form').addEventListener('submit', handleFormSubmit);
        };

        const handleSearch = () => {
            const query = document.getElementById('search-input').value;
            fetchEntityList(state.currentEntity, query).then(renderListPage);
        };

        const handleFormSubmit = async (e) => {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            const data = {};
            
            // Popula o objeto de dados a ser enviado
            for (let [key, value] of formData.entries()) {
                if (key === 'id' && !value) continue; // Ignora ID vazio na criação
                data[key] = value;
            }

            // Lógica específica para Cachorro (separar FichaCachorro)
            if (state.currentEntity === 'cachorros') {
                const fichaKeys = ['descricaoHistoria', 'temperamentoPrincipal', 'habilidadesEspeciais'];
                const ficha = {};
                fichaKeys.forEach(key => {
                    // Mapeia o valor para o objeto ficha
                    ficha[key] = data[key] || null;
                    // Remove do objeto pai
                    delete data[key];
                });
                // Garante que a ficha seja enviada como objeto aninhado
                data.ficha = ficha; 
            }
            
            // Lógica específica para Adoção (simulação de objetos aninhados)
            if (state.currentEntity === 'adocoes') {
                if (data.cachorroId) {
                    // A API espera um objeto Cachorro com o id
                    data.cachorro = { id: parseInt(data.cachorroId) }; 
                    delete data.cachorroId;
                } else {
                    // Evita enviar { "cachorro": "" }
                    delete data.cachorro;
                }
                // Racas é um array vazio por simplificação
                data.racas = [];
            }


            const success = await saveEntity(state.currentEntity, data, data.id);
            if (success) {
                // Se salvar com sucesso, volta para a lista e recarrega
                state.selectedId = null;
                showPage('list', state.currentEntity);
            }
        };


        // CONTROLLER PRINCIPAL
        const showPage = async (page, entity = state.currentEntity) => {
            state.currentPage = page;
            state.currentEntity = entity;
            
            // Redefine selectedId ao trocar de aba ou ir para a lista
            if (page === 'list' || page === 'form' && state.selectedId === null) {
                state.selectedId = null; 
            }
            
            renderHeader();
            
            if (page === 'list') {
                await fetchEntityList(state.currentEntity);
                renderListPage();
            } else if (page === 'form') {
                renderFormPage();
            }
            
            window.scrollTo(0, 0); // Volta para o topo ao trocar de página
        };

        // GERAÇÃO DE DADOS MOCKADOS (apenas para demonstração)
        const generateMockData = (entity) => {
            if (entity === 'cachorros') {
                return [
                    { id: 1, nome: 'Thor', dataDeNascimento: '2023-01-15', localDeResgate: 'Praça Central', ficha: { descricaoHistoria: 'Resgatado em dia de chuva, muito amigável.', temperamentoPrincipal: 'Brincalhão', habilidadesEspeciais: 'Senta e deita' } },
                    { id: 2, nome: 'Luna', dataDeNascimento: '2022-05-20', localDeResgate: 'Zona Rural', ficha: { descricaoHistoria: 'Encontrada em uma fazenda, dócil e protetora.', temperamentoPrincipal: 'Calma', habilidadesEspeciais: 'Obediência básica' } },
                    { id: 3, nome: 'Pingo', dataDeNascimento: '2024-03-01', localDeResgate: 'Bairro Novo', ficha: { descricaoHistoria: 'Filhote abandonado, cheio de energia.', temperamentoPrincipal: 'Energético', habilidadesEspeciais: 'Nenhuma ainda' } },
                    { id: 4, nome: 'Max', dataDeNascimento: '2021-11-10', localDeResgate: 'Rodovia BR-101', ficha: { descricaoHistoria: 'Cão adulto, experiente e educado.', temperamentoPrincipal: 'Leal', habilidadesEspeciais: 'Guarda' } }
                ];
            } else if (entity === 'adocoes') {
                return [
                    { id: 101, dataSolicitacao: '2024-09-28', justificativa: 'Temos um quintal grande e amamos cães.', status: 'APROVADA', cachorro: { id: 1, nome: 'Thor' }, racas: [{ id: 1, nome: 'Vira-Lata' }] },
                    { id: 102, dataSolicitacao: '2024-09-29', justificativa: 'Queremos um companheiro para a família.', status: 'PENDENTE', cachorro: { id: 3, nome: 'Pingo' }, racas: [] },
                ];
            } else if (entity === 'racas') {
                return [
                    { id: 1, nome: 'Vira-Lata', descricao: 'Mestiço, a raça mais comum e amada no Brasil.' },
                    { id: 2, nome: 'Poodle', descricao: 'Pequeno, muito inteligente e hipoalergênico.' },
                    { id: 3, nome: 'Labrador', descricao: 'Amigável, excelente cão de família.' },
                ];
            }
            return [];
        };

        // INICIALIZAÇÃO
        window.onload = () => {
            // Inicia o aplicativo na lista de cachorros
            showPage('list', 'cachorros'); 
        };
    </script>
</head>
<body class="bg-gray-50">

    <div class="min-h-screen flex flex-col">
        <!-- Cabeçalho Fixo -->
        <header class="sticky top-0 bg-white shadow-md z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                <div class="flex flex-col sm:flex-row justify-between items-center">
                    <h1 class="text-3xl font-extrabold text-emerald-600 mb-2 sm:mb-0">
                        🐶 Cão Amigo
                    </h1>
                    <!-- Navegação Principal -->
                    <nav id="main-nav" class="flex space-x-4 border-b border-gray-200">
                        <!-- Conteúdo gerado via JS -->
                    </nav>
                </div>
            </div>
        </header>

        <!-- Container Principal de Conteúdo -->
        <main class="flex-grow max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8">
            <!-- Indicador de Mensagem -->
            <div id="message-container"></div>
            
            <!-- Indicador de Loading -->
            <div id="loading-indicator" class="hidden fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50">
                <div class="flex flex-col items-center">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500"></div>
                    <p class="mt-4 text-emerald-600 font-semibold">Carregando...</p>
                </div>
            </div>

            <!-- Conteúdo Dinâmico -->
            <div id="content-container">
                <!-- O conteúdo (lista ou formulário) será injetado aqui pelo JavaScript -->
            </div>
        </main>
        
        <!-- Rodapé -->
        <footer class="bg-white border-t border-gray-200 mt-10">
            <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm text-gray-500">
                Desenvolvido com base na API Cão Amigo (OpenAPI v3.0.4) | Frontend em HTML, Tailwind CSS e JS Puro.
            </div>
        </footer>
    </div>

</body>
</html>
